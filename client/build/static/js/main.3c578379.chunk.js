(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{17:function(e,t,a){e.exports=a(27)},26:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(15),s=a.n(c),l=a(3),o=a.n(l),i=a(13),u=a(12),p=a(7),h=a(8),f=a(10),d=a(9),m=a(11),v=a(28),g=a(29),b=a(30),w=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(f.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(c)))).fileInputRef=r.a.createRef(),a.handleClick=function(){a.fileInputRef.current.click()},a}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.loading;return r.a.createElement("div",null,r.a.createElement("input",{ref:this.fileInputRef,accept:"image/*",style:{display:"none "},type:"file",onChange:this.props.onUpload}),r.a.createElement(b.a,{color:"primary",disabled:a,onClick:this.handleClick},t))}}]),t}(n.PureComponent),k=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(f.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,success:null,message:"",preview:null,cats:[]},a.fetchCat=function(e){return new Promise(function(){var t=Object(u.a)(o.a.mark((function t(n){var r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/cats/".concat(e));case 2:return r=t.sent,t.next=5,r.blob();case 5:c=t.sent,s=URL.createObjectURL(c),a.setState((function(t){return{cats:[{id:e,url:s}].concat(Object(i.a)(t.cats))}}),n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},a.fetchCats=function(){a.setState({cats:[]},Object(u.a)(o.a.mark((function e(){var t,n,r,c,s,l,i,u,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/cats");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r=n.cats,c=!0,s=!1,l=void 0,e.prev=10,i=r[Symbol.iterator]();case 12:if(c=(u=i.next()).done){e.next=19;break}return p=u.value,e.next=16,a.fetchCat(p);case 16:c=!0,e.next=12;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(10),s=!0,l=e.t0;case 25:e.prev=25,e.prev=26,c||null==i.return||i.return();case 28:if(e.prev=28,!s){e.next=31;break}throw l;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}}),e,null,[[10,21,25,33],[26,,28,32]])}))))},a.handleUpload=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,s,l,u,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentTarget.files[0],r=new FormData,a.setState({loading:!0,preview:null,message:""}),r.append("image",n),e.prev=4,e.next=7,fetch("/api/upload",{method:"POST",body:r});case 7:return c=e.sent,e.next=10,c.json();case 10:s=e.sent,l=s.message,u=201===c.status,a.setState({success:u,message:l}),(p=new FileReader).onload=function(e){console.log(e.target.result),u?a.setState((function(t){return{cats:[{id:t.cats.length,url:e.target.result}].concat(Object(i.a)(t.cats))}})):a.setState({preview:e.target.result})},p.readAsDataURL(n),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),console.error(e.t0);case 22:a.setState({loading:!1});case 23:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){this.fetchCats()}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.success,n=e.message,c=e.preview,s=e.cats;return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{color:"light",light:!0},r.a.createElement(g.a,{href:"/"},"CatBook")),r.a.createElement("div",{style:{padding:32}},n&&r.a.createElement("h6",null,n),c&&r.a.createElement("div",{className:"crossed"},r.a.createElement("img",{src:c,alt:"upload preview",style:{maxHeight:300}})),r.a.createElement(w,{onUpload:this.handleUpload,loading:t,success:a},"Upload Cat"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("h6",null,"Recent cats:"),r.a.createElement("br",null),s.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("img",{src:e.url,alt:"cat",style:{maxHeight:300}}))}))))}}]),t}(n.Component);a(25),a(26),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[17,1,2]]]);
//# sourceMappingURL=main.3c578379.chunk.js.map